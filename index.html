<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø£Ø±ÙŠÙ†Ø§ Ø§Ù„Ø¹Ø¨Ø§Ù‚Ø±Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.8);
            --primary: #3b82f6;
            --accent: #8b5cf6;
            --neon-blue: #00f3ff;
            --neon-pink: #ff00ff;
            --success: #10b981;
            --danger: #ef4444;
            --text-main: #f8fafc;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        body {
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(139, 92, 246, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(59, 130, 246, 0.15) 0%, transparent 20%);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-wrapper {
            width: 100%;
            max-width: 500px;
            position: relative;
            z-index: 10;
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header {
            text-align: center;
            margin-bottom: 30px;
            animation: slideDown 0.5s ease;
        }

        h1 {
            font-size: 32px;
            font-weight: 900;
            background: linear-gradient(to right, var(--neon-blue), var(--neon-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(0, 243, 255, 0.3);
            margin-bottom: 5px;
        }

        .subtitle {
            font-size: 14px;
            color: #94a3b8;
            letter-spacing: 1px;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ */
        .nav-pills {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 5px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            flex: 1;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            border-radius: 15px;
            font-weight: 700;
            transition: all 0.3s ease;
            color: #94a3b8;
        }

        .nav-item.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-card {
            background: var(--card-bg);
            border-radius: 24px;
            padding: 25px;
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .game-card.active {
            display: block;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª */
        .info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 700;
            color: var(--neon-blue);
        }

        /* Ø§Ù„Ù…Ø¤Ù‚Øª */
        .timer-bar-container {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
        }

        .timer-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-blue), var(--primary));
            width: 100%;
            transition: width 1s linear;
            border-radius: 10px;
        }

        /* Ø§Ù„Ø³Ø¤Ø§Ù„ */
        .question-box {
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.6;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª */
        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.05);
            padding: 16px;
            border-radius: 16px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .option-btn:active {
            transform: scale(0.98);
        }

        .option-btn.correct {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
            color: var(--success);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
        }

        .option-btn.wrong {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger);
            color: var(--danger);
        }

        .option-btn.disabled {
            pointer-events: none;
            opacity: 0.6;
        }

        /* Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ */
        .next-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border: none;
            border-radius: 16px;
            color: white;
            font-size: 18px;
            font-weight: 700;
            margin-top: 25px;
            cursor: pointer;
            display: none;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            animation: slideUp 0.3s ease;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ© */
        .overlay-screen {
            text-align: center;
            padding: 20px 0;
        }

        .big-icon {
            font-size: 60px;
            margin-bottom: 20px;
            display: block;
        }

        .start-btn, .restart-btn {
            background: white;
            color: var(--bg-dark);
            padding: 15px 40px;
            font-size: 18px;
            font-weight: 900;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        /* Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ù„ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… */
        .level-badges {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }

        .badge {
            font-size: 10px;
            padding: 4px 10px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: #64748b;
            border: 1px solid transparent;
        }

        .badge.active {
            background: rgba(245, 158, 11, 0.2);
            color: #fbbf24;
            border-color: #fbbf24;
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.2);
        }

        /* Ø§Ù†ÙŠÙ…ÙŠØ´Ù† */
        @keyframes slideDown { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Ø§Ù„Ø´Ø¹Ø§Ø± ÙˆØ§Ù„Ù†ØªÙŠØ¬Ø© */
        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid var(--neon-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            font-weight: 900;
            margin: 0 auto 20px;
            background: rgba(0, 243, 255, 0.1);
            box-shadow: 0 0 30px rgba(0, 243, 255, 0.2);
        }

    </style>
</head>
<body>

    <div class="game-wrapper">
        <header>
            <h1>Ø£Ø±ÙŠÙ†Ø§ Ø§Ù„Ø¹Ø¨Ø§Ù‚Ø±Ø©</h1>
            <p class="subtitle">Ù‡Ù„ Ø¹Ù‚Ù„Ùƒ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ø¯ÙŠØŸ</p>
        </header>

        <div class="nav-pills">
            <div class="nav-item active" id="tab-iq" onclick="switchTab('iq')">ğŸ§  Ø§Ø®ØªØ¨Ø§Ø± IQ</div>
            <div class="nav-item" id="tab-fb" onclick="switchTab('fb')">âš½ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</div>
        </div>

        <div id="game-iq" class="game-card active">
            <div id="iq-start-screen" class="overlay-screen">
                <span class="big-icon">ğŸ’¡</span>
                <h2>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ ÙˆØ§Ù„Ù…Ù†Ø·Ù‚</h2>
                <p style="color: #94a3b8; margin: 15px 0;">10 Ø£Ø³Ø¦Ù„Ø© ØªÙ‚ÙŠØ³ Ø³Ø±Ø¹Ø© Ø¨Ø¯ÙŠÙ‡ØªÙƒ ÙˆÙ…Ù†Ø·Ù‚Ùƒ.<br>Ù„Ø¯ÙŠÙƒ 20 Ø«Ø§Ù†ÙŠØ© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„.</p>
                <button class="start-btn" onclick="startIQGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ</button>
            </div>

            <div id="iq-play-screen" style="display:none;">
                <div class="info-bar">
                    <span>Ù†Ù‚Ø§Ø·Ùƒ: <span id="iq-score-display">0</span></span>
                    <span>Ø³Ø¤Ø§Ù„: <span id="iq-count-display">1/10</span></span>
                </div>
                <div class="timer-bar-container">
                    <div id="iq-timer-bar" class="timer-bar"></div>
                </div>
                <div class="question-box" id="iq-question-text"></div>
                <div class="options-grid" id="iq-options-container"></div>
                <button id="iq-next-btn" class="next-btn" onclick="nextIQQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>

            <div id="iq-result-screen" class="overlay-screen" style="display:none;">
                <div class="score-circle" id="iq-final-score">0</div>
                <h2 id="iq-result-title"></h2>
                <p id="iq-result-msg" style="color: #cbd5e1; margin-top: 10px;"></p>
                <button class="restart-btn" onclick="resetIQUI()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
        </div>

        <div id="game-fb" class="game-card">
            <div class="level-badges">
                <div class="badge active" id="badge-1">Ù…Ø¨ØªØ¯Ø¦</div>
                <div class="badge" id="badge-2">Ù‡Ø§ÙˆÙŠ</div>
                <div class="badge" id="badge-3">Ù…Ø­ØªØ±Ù</div>
                <div class="badge" id="badge-4">Ø£Ø³Ø·ÙˆØ±Ø©</div>
            </div>

            <div id="fb-start-screen" class="overlay-screen">
                <span class="big-icon">âš½</span>
                <h2>Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙƒØ±ÙˆÙŠØ©</h2>
                <p style="color: #94a3b8; margin: 15px 0;">ØªØ¯Ø±Ø¬ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ù…Ù† Ø§Ù„Ù…Ø¨ØªØ¯Ø¦ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©.<br>ØªØ­ØªØ§Ø¬ 3 Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø© Ù„ØªØ¬Ø§ÙˆØ² ÙƒÙ„ Ù…Ø³ØªÙˆÙ‰.</p>
                <button class="start-btn" onclick="startFBGame(1)">Ø§Ù†Ø·Ù„Ø§Ù‚ Ø§Ù„ØµØ§ÙØ±Ø©</button>
            </div>

            <div id="fb-play-screen" style="display:none;">
                <div class="info-bar">
                    <span>Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="fb-score-display">0</span>/5</span>
                    <span>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="fb-level-display">1</span></span>
                </div>
                <div class="timer-bar-container">
                    <div id="fb-timer-bar" class="timer-bar" style="background: linear-gradient(90deg, #f59e0b, #d97706);"></div>
                </div>
                <div class="question-box" id="fb-question-text"></div>
                <div class="options-grid" id="fb-options-container"></div>
                <button id="fb-next-btn" class="next-btn" onclick="nextFBQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>

            <div id="fb-result-screen" class="overlay-screen" style="display:none;">
                <span class="big-icon" id="fb-result-icon">ğŸ†</span>
                <h2 id="fb-result-title"></h2>
                <p id="fb-result-msg" style="color: #cbd5e1; margin: 15px 0;"></p>
                <div id="fb-action-btns">
                    </div>
            </div>
        </div>
    </div>

    <script>
        // ================= Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (IQ) =================
        const iqData = [
            { t: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ÙÙ‚ÙˆØ¯: 3, 6, 12, 24, ... ØŸ", opts: ["30", "36", "48", "42"], a: "48" },
            { t: "Ø¥Ø°Ø§ ÙƒØ§Ù† (Ø£Ù…Ø³) Ù‡Ùˆ ØºØ¯Ø§Ù‹ØŒ ÙØ§Ù„ÙŠÙˆÙ… Ù‡Ùˆ (Ø§Ù„Ø¬Ù…Ø¹Ø©). ÙÙŠ Ø£ÙŠ ÙŠÙˆÙ… Ù‚Ø§Ù„ Ù‡Ø°Ø§ØŸ", opts: ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø³Ø¨Øª", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡"], a: "Ø§Ù„Ø£Ø­Ø¯" },
            { t: "Ù…Ø§ Ù‡Ùˆ Ù†ØµÙ Ø§Ù„Ø§Ø«Ù†ÙŠÙ† Ø²Ø§Ø¦Ø¯ Ø§Ø«Ù†ÙŠÙ†ØŸ", opts: ["3", "2", "4", "1"], a: "3" }, // Ù†ØµÙ (2) = 1 + 2 = 3
            { t: "Ø´ÙŠØ¡ ÙƒÙ„Ù…Ø§ Ø²Ø§Ø¯ Ù†Ù‚ØµØŒ Ù…Ø§ Ù‡ÙˆØŸ", opts: ["Ø§Ù„Ù…Ø§Ù„", "Ø§Ù„Ø¹Ù…Ø±", "Ø§Ù„ÙˆØ²Ù†", "Ø§Ù„Ø°ÙƒØ§Ø¡"], a: "Ø§Ù„Ø¹Ù…Ø±" },
            { t: "Ø¹Ø§Ø¦Ù„Ø© Ù…Ø¤Ù„ÙØ© Ù…Ù† 5 Ø¨Ù†Ø§ØªØŒ ÙˆÙ„ÙƒÙ„ Ø¨Ù†Øª Ø£Ø® ÙˆØ§Ø­Ø¯. ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø°ÙƒÙˆØ±ØŸ", opts: ["5", "1", "6", "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ"], a: "1" },
            { t: "Ø£ÙŠÙ‡Ù…Ø§ Ø£Ø«Ù‚Ù„: ÙƒÙŠÙ„Ùˆ Ø­Ø¯ÙŠØ¯ Ø£Ù… ÙƒÙŠÙ„Ùˆ Ù‚Ø·Ù†ØŸ", opts: ["Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ù‚Ø·Ù†", "Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†", "Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹"], a: "Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†" },
            { t: "Ø´Ø®Øµ ÙŠØ±Ù‰ ØµØ¯ÙŠÙ‚Ù‡ ÙˆØ¹Ø¯ÙˆÙ‡ Ø¨Ø¹ÙŠÙ† ÙˆØ§Ø­Ø¯Ø©ØŒ Ù…Ù† Ù‡ÙˆØŸ", opts: ["Ø§Ù„Ø£Ø¹Ù…Ù‰", "Ø§Ù„Ø£Ø¹ÙˆØ±", "Ø§Ù„Ù…Ù†Ø§ÙÙ‚", "Ø§Ù„Ø­ÙƒÙŠÙ…"], a: "Ø§Ù„Ø£Ø¹ÙˆØ±" },
            { t: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø´ÙŠ Ø¨Ù„Ø§ Ø£Ø±Ø¬Ù„ ÙˆÙŠØ¨ÙƒÙŠ Ø¨Ù„Ø§ Ø¹ÙŠÙˆÙ†ØŸ", opts: ["Ø§Ù„Ù†Ù‡Ø±", "Ø§Ù„Ø³Ø­Ø§Ø¨", "Ø§Ù„Ø±ÙŠØ­", "Ø§Ù„Ù‚Ù„Ù…"], a: "Ø§Ù„Ø³Ø­Ø§Ø¨" },
            { t: "4, 9, 16, 25, ... ØŸ", opts: ["30", "36", "40", "49"], a: "36" },
            { t: "Ø£Ø®Øª Ø®Ø§Ù„Ùƒ ÙˆÙ„ÙŠØ³Øª Ø®Ø§Ù„ØªÙƒØŒ Ù…Ù† ØªÙƒÙˆÙ†ØŸ", opts: ["Ø¬Ø¯ØªÙƒ", "Ø£Ù…Ùƒ", "Ø£Ø®ØªÙƒ", "Ø¹Ù…ØªÙƒ"], a: "Ø£Ù…Ùƒ" },
            { t: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø´ÙŠØ¡ Ø§Ù„Ø°ÙŠ ØªØ£ÙƒÙ„ Ù…Ù†Ù‡ ÙˆÙ„Ø§ ÙŠØ¤ÙƒÙ„ØŸ", opts: ["Ø§Ù„Ø·Ø¨Ù‚", "Ø§Ù„Ù…Ù„Ø¹Ù‚Ø©", "Ø§Ù„Ø³Ù…Ùƒ", "Ø§Ù„Ø®Ø¨Ø²"], a: "Ø§Ù„Ø·Ø¨Ù‚" },
            { t: "Ø´ÙŠØ¡ ÙŠØªØ­Ø¯Ø« Ø¨ÙƒÙ„ Ù„ØºØ§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", opts: ["Ø§Ù„Ù…ØªØ±Ø¬Ù…", "Ø§Ù„ØµØ¯Ù‰", "Ø§Ù„Ù‡Ø§ØªÙ", "Ø§Ù„Ø±Ø§Ø¯ÙŠÙˆ"], a: "Ø§Ù„ØµØ¯Ù‰" }
        ];

        // ================= Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…) =================
        const fbData = {
            1: [ // Ù…Ø¨ØªØ¯Ø¦
                { t: "Ù…Ù† Ø­Ù‚Ù‚ ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2022ØŸ", opts: ["Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†", "ÙØ±Ù†Ø³Ø§", "Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„"], a: "Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†" },
                { t: "Ù…Ø§ Ù‡Ùˆ Ù„ÙˆÙ† ÙƒØ±Øª Ø§Ù„Ø·Ø±Ø¯ØŸ", opts: ["Ø£ØµÙØ±", "Ø£Ø­Ù…Ø±", "Ø£Ø¨ÙŠØ¶"], a: "Ø£Ø­Ù…Ø±" },
                { t: "ÙƒÙ… Ø´ÙˆØ· ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©ØŸ", opts: ["1", "2", "3"], a: "2" },
                { t: "Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ Ù„Ù…ÙŠØ³ÙŠØŸ", opts: ["Ø¨Ø§Ø±ÙŠØ³", "Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©", "Ù…ÙŠØ§Ù…ÙŠ"], a: "Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©" },
                { t: "Ø£ÙŠÙ† ÙŠÙ‚Ø¹ Ø±ÙŠØ§Ù„ Ù…Ø¯Ø±ÙŠØ¯ØŸ", opts: ["Ø¥Ù†Ø¬Ù„ØªØ±Ø§", "Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§", "Ø¥ÙŠØ·Ø§Ù„ÙŠØ§"], a: "Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§" }
            ],
            2: [ // Ù‡Ø§ÙˆÙŠ
                { t: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ Ù„Ù„Ø¨Ø±ØªØºØ§Ù„ØŸ", opts: ["ÙÙŠØºÙˆ", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "Ù†Ø§Ù†ÙŠ"], a: "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ" },
                { t: "Ù…Ø§ Ù‡Ùˆ Ù„Ù‚Ø¨ Ù…Ù†ØªØ®Ø¨ Ù…ØµØ±ØŸ", opts: ["Ø§Ù„Ù†Ø³ÙˆØ±", "Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©", "Ø§Ù„Ø£Ø³ÙˆØ¯"], a: "Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©" },
                { t: "Ù†Ø§Ø¯ÙŠ ÙŠÙ„Ù‚Ø¨ Ø¨Ø§Ù„Ø³ÙŠØ¯Ø© Ø§Ù„Ø¹Ø¬ÙˆØ²ØŸ", opts: ["ÙŠÙˆÙÙ†ØªÙˆØ³", "Ù…ÙŠÙ„Ø§Ù†", "Ø±ÙˆÙ…Ø§"], a: "ÙŠÙˆÙÙ†ØªÙˆØ³" },
                { t: "Ø£ÙƒØ«Ø± Ù…Ù†ØªØ®Ø¨ Ø­Ù‚Ù‚ ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", opts: ["Ø£Ù„Ù…Ø§Ù†ÙŠØ§", "Ø¥ÙŠØ·Ø§Ù„ÙŠØ§", "Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„"], a: "Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„" },
                { t: "Ù„Ø§Ø¹Ø¨ ÙŠÙ„Ù‚Ø¨ Ø¨Ø§Ù„Ø¸Ø§Ù‡Ø±Ø©ØŸ", opts: ["Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ", "ÙƒØ±ÙŠØ³ØªÙŠØ§Ù†Ùˆ", "Ù…ÙŠØ³ÙŠ"], a: "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ÙŠ" }
            ],
            3: [ // Ù…Ø­ØªØ±Ù
                { t: "Ù…Ù† ÙØ§Ø² Ø¨Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© 2018ØŸ", opts: ["Ù…ÙˆØ¯Ø±ÙŠØªØ´", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "Ù…ÙŠØ³ÙŠ"], a: "Ù…ÙˆØ¯Ø±ÙŠØªØ´" },
                { t: "Ø§Ù„Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ Ù„ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", opts: ["Ø¨ÙŠÙ„ÙŠÙ‡", "ÙƒÙ„ÙˆØ²Ù‡", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ"], a: "ÙƒÙ„ÙˆØ²Ù‡" },
                { t: "ÙÙŠ Ø£ÙŠ Ø³Ù†Ø© ØªØ£Ø³Ø³ Ø¨Ø±Ø´Ù„ÙˆÙ†Ø©ØŸ", opts: ["1899", "1902", "1900"], a: "1899" },
                { t: "Ù…Ø¯Ø±Ø¨ Ø­Ù‚Ù‚ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠØ© Ù…Ø¹ Ø§Ù„Ø¥Ù†ØªØ±ØŸ", opts: ["Ù…ÙˆØ±ÙŠÙ†ÙŠÙˆ", "ÙƒÙˆÙ†ØªÙŠ", "Ù…Ø§Ù†Ø´ÙŠÙ†ÙŠ"], a: "Ù…ÙˆØ±ÙŠÙ†ÙŠÙˆ" },
                { t: "Ø£ÙŠÙ† Ø£Ù‚ÙŠÙ… Ù…ÙˆÙ†Ø¯ÙŠØ§Ù„ 1998ØŸ", opts: ["ÙØ±Ù†Ø³Ø§", "Ø§Ù„Ø±Ø§Ø²ÙŠÙ„", "Ø£Ù„Ù…Ø§Ù†ÙŠØ§"], a: "ÙØ±Ù†Ø³Ø§" }
            ],
            4: [ // Ø£Ø³Ø·ÙˆØ±Ø©
                { t: "Ø§Ù„Ø­Ø§Ø±Ø³ Ø§Ù„ÙˆØ­ÙŠØ¯ Ø§Ù„ÙØ§Ø¦Ø² Ø¨Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©ØŸ", opts: ["Ø¨ÙˆÙÙˆÙ†", "ÙŠØ§Ø´ÙŠÙ†", "Ù†ÙˆÙŠØ±"], a: "ÙŠØ§Ø´ÙŠÙ†" },
                { t: "Ù‡Ø¯Ø§Ù ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 1986ØŸ", opts: ["Ù…Ø§Ø±Ø§Ø¯ÙˆÙ†Ø§", "Ù„ÙŠÙ†ÙŠÙƒØ±", "Ø¨Ù„Ø§ØªÙŠÙ†ÙŠ"], a: "Ù„ÙŠÙ†ÙŠÙƒØ±" }, // Ù…Ø§Ø±Ø§Ø¯ÙˆÙ†Ø§ Ø£ÙØ¶Ù„ Ù„Ø§Ø¹Ø¨ØŒ Ù„ÙŠÙ†ÙŠÙƒØ± Ø§Ù„Ù‡Ø¯Ø§Ù
                { t: "Ø£ÙˆÙ„ Ù…Ù†ØªØ®Ø¨ Ø¹Ø±Ø¨ÙŠ Ø´Ø§Ø±Ùƒ Ø¨Ø§Ù„Ù…ÙˆÙ†Ø¯ÙŠØ§Ù„ØŸ", opts: ["Ù…ØµØ±", "Ø§Ù„Ù…ØºØ±Ø¨", "ØªÙˆÙ†Ø³"], a: "Ù…ØµØ±" },
                { t: "Ø£ÙƒØ«Ø± Ù„Ø§Ø¹Ø¨ Ø­Ù‚Ù‚ Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„ØŸ", opts: ["Ø®ÙŠÙ†ØªÙˆ", "Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ", "Ù…Ø§Ù„Ø¯ÙŠÙ†ÙŠ"], a: "Ø®ÙŠÙ†ØªÙˆ" },
                { t: "Ù…Ù† Ø³Ø¬Ù„ Ù‡Ø¯Ù Ø£Ù„Ù…Ø§Ù†ÙŠØ§ ÙÙŠ Ù†Ù‡Ø§Ø¦ÙŠ 2014ØŸ", opts: ["Ù…ÙˆÙ„Ø±", "ØºÙˆØªØ²Ù‡", "ÙƒÙ„ÙˆØ²Ù‡"], a: "ØºÙˆØªØ²Ù‡" }
            ]
        };

        // ================= Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© =================
        let gameState = {
            type: 'iq', // 'iq' or 'fb'
            score: 0,
            index: 0,
            timer: 0,
            interval: null,
            level: 1,
            questions: []
        };

        // ================= Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª =================
        function switchTab(type) {
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø´ÙŠØ¡
            stopGameTimer();
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.game-card').forEach(el => el.classList.remove('active'));
            
            document.getElementById(`tab-${type}`).classList.add('active');
            document.getElementById(`game-${type}`).classList.add('active');
            
            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
            if (type === 'iq') resetIQUI();
            else resetFBUI();
        }

        // ================= Ù…Ø­Ø±Ùƒ Ù„Ø¹Ø¨Ø© IQ =================
        function resetIQUI() {
            document.getElementById('iq-start-screen').style.display = 'block';
            document.getElementById('iq-play-screen').style.display = 'none';
            document.getElementById('iq-result-screen').style.display = 'none';
        }

        function startIQGame() {
            // Ø®Ù„Ø· Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ø®ØªÙŠØ§Ø± 10
            gameState.questions = [...iqData].sort(() => Math.random() - 0.5).slice(0, 10);
            gameState.score = 0;
            gameState.index = 0;
            
            document.getElementById('iq-start-screen').style.display = 'none';
            document.getElementById('iq-play-screen').style.display = 'block';
            
            renderIQQuestion();
        }

        function renderIQQuestion() {
            const q = gameState.questions[gameState.index];
            document.getElementById('iq-count-display').innerText = `${gameState.index + 1}/10`;
            document.getElementById('iq-score-display').innerText = gameState.score;
            document.getElementById('iq-question-text').innerText = q.t;
            document.getElementById('iq-next-btn').style.display = 'none';

            const optsDiv = document.getElementById('iq-options-container');
            optsDiv.innerHTML = '';

            let shuffledOpts = [...q.opts].sort(() => Math.random() - 0.5);
            shuffledOpts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkIQAnswer(btn, opt, q.a);
                optsDiv.appendChild(btn);
            });

            startTimer(20, 'iq-timer-bar', () => handleTimeout('iq-options-container', q.a, 'iq-next-btn'));
        }

        function checkIQAnswer(btn, selected, correct) {
            if (document.querySelector('#iq-options-container .disabled')) return; // Ù…Ù†Ø¹ Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù…ØªÙƒØ±Ø±
            stopGameTimer();
            
            const allBtns = document.querySelectorAll('#iq-options-container .option-btn');
            allBtns.forEach(b => b.classList.add('disabled'));

            if (selected === correct) {
                btn.classList.add('correct');
                gameState.score += 10;
                document.getElementById('iq-score-display').innerText = gameState.score;
            } else {
                btn.classList.add('wrong');
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­
                allBtns.forEach(b => {
                    if (b.innerText === correct) b.classList.add('correct');
                });
            }
            document.getElementById('iq-next-btn').style.display = 'block';
        }

        function nextIQQuestion() {
            gameState.index < gameState.questions.length) {
                renderIQQuestion();
            } else {
                showIQResult();
            }
        }

        function showIQResult() {
            document.getElementById('iq-play-screen').style.display = 'none';
            document.getElementById('iq-result-screen').style.display = 'block';
            document.getElementById('iq-final-score').innerText = gameState.score;
            
            let title = "", msg = "";
            if (gameState.score >= 90) { title = "Ø£Ù†Øª Ø¹Ø¨Ù‚Ø±ÙŠ! ğŸ¤¯"; msg = "Ù…Ø³ØªÙˆÙ‰ Ø°ÙƒØ§Ø¡ Ø®Ø§Ø±Ù‚ØŒ Ù‡Ù†ÙŠØ¦Ø§Ù‹ Ù„Ùƒ!"; }
            else if (gameState.score >= 70) { title = "Ø°ÙƒÙŠ Ø¬Ø¯Ø§Ù‹ ğŸ¤“"; msg = "Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²ØŒ Ø¹Ù‚Ù„Ùƒ ÙŠØ¹Ù…Ù„ Ø¨ÙƒÙØ§Ø¡Ø©!"; }
            else if (gameState.score >= 50) { title = "Ù…Ø³ØªÙˆÙ‰ Ø¬ÙŠØ¯ ğŸ™‚"; msg = "Ù†ØªÙŠØ¬Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ­Ø³Ù†."; }
            else { title = "Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ğŸ˜…"; msg = "Ù„Ø§ Ø¨Ø£Ø³ØŒ Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙŠØ±ÙØ¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø°ÙƒØ§Ø¡."; }
            
            document.getElementById('iq-result-title').innerText = title;
            document.getElementById('iq-result-msg').innerText = msg;
        }

        // ================= Ù…Ø­Ø±Ùƒ Ù„Ø¹Ø¨Ø© ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… =================
        function resetFBUI() {
            document.getElementById('fb-start-screen').style.display = 'block';
            document.getElementById('fb-play-screen').style.display = 'none';
            document.getElementById('fb-result-screen').style.display = 'none';
            updateLevelBadges(1);
        }

        function startFBGame(level) {
            gameState.level = level;
            // Ù†Ø³Ø® Ø¹Ù…ÙŠÙ‚ Ù„Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ®Ù„Ø·Ù‡Ø§
            gameState.questions = [...fbData[level]].sort(() => Math.random() - 0.5);
            gameState.score = 0;
            gameState.index = 0;
            
            updateLevelBadges(level);
            
            document.getElementById('fb-start-screen').style.display = 'none';
            document.getElementById('fb-result-screen').style.display = 'none';
            document.getElementById('fb-play-screen').style.display = 'block';
            
            renderFBQuestion();
        }

        function renderFBQuestion() {
            const q = gameState.questions[gameState.index];
            document.getElementById('fb-level-display').innerText = gameState.level;
            document.getElementById('fb-score-display').innerText = gameState.score;
            document.getElementById('fb-question-text').innerText = q.t;
            document.getElementById('fb-next-btn').style.display = 'none';

            const optsDiv = document.getElementById('fb-options-container');
            optsDiv.innerHTML = '';

            let shuffledOpts = [...q.opts].sort(() => Math.random() - 0.5);
            shuffledOpts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkFBAnswer(btn, opt, q.a);
                optsDiv.appendChild(btn);
            });

            startTimer(15, 'fb-timer-bar', () => handleTimeout('fb-options-container', q.a, 'fb-next-btn'));
        }

        function checkFBAnswer(btn, selected, correct) {
            if (document.querySelector('#fb-options-container .disabled')) return;
            stopGameTimer();

            const allBtns = document.querySelectorAll('#fb-options-container .option-btn');
            allBtns.forEach(b => b.classList.add('disabled'));

            if (selected === correct) {
                btn.classList.add('correct');
                gameState.score++;
                document.getElementById('fb-score-display').innerText = gameState.score;
            } else {
                btn.classList.add('wrong');
                allBtns.forEach(b => {
                    if (b.innerText === correct) b.classList.add('correct');
                });
            }
            document.getElementById('fb-next-btn').style.display = 'block';
        }

        function nextFBQuestion() {
            gameState.index++;
            if (gameState.index < 5) { // 5 Ø£Ø³Ø¦Ù„Ø© Ù„ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©
                renderFBQuestion();
            } else {
                showFBResult();
            }
        }

        function showFBResult() {
            document.getElementById('fb-play-screen').style.display = 'none';
            document.getElementById('fb-result-screen').style.display = 'block';
            
            const passed = gameState.score >= 3;
            const titleEl = document.getElementById('fb-result-title');
            const msgEl = document.getElementById('fb-result-msg');
            const btnsDiv = document.getElementById('fb-action-btns');
            
            btnsDiv.innerHTML = '';

            if (passed) {
                if (gameState.level === 4) {
                    titleEl.innerText = "Ø®ØªÙ…Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ÙŠØ§ Ø£Ø³Ø·ÙˆØ±Ø©! ğŸ†";
                    msgEl.innerText = `Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ…Ø§Ù„! Ù„Ù‚Ø¯ Ø£Ù†Ù‡ÙŠØª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±Ø§Ø­Ù„ Ø¨Ù†Ø¬Ø§Ø­.`;
                    btnsDiv.innerHTML = `<button class="restart-btn" onclick="resetFBUI()">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</button>`;
                } else {
                    titleEl.innerText = "Ù…Ø±Ø­Ù„Ø© Ù…ÙƒØªÙ…Ù„Ø©! âœ…";
                    msgEl.innerText = `Ø£Ø¬Ø¨Øª Ø¹Ù„Ù‰ ${gameState.score}/5. Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ØµØ¹Ø¨!`;
                    btnsDiv.innerHTML = `<button class="start-btn" onclick="startFBGame(${gameState.level + 1})">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ</button>`;
                }
            } else {
                titleEl.innerText = "Ù„Ù„Ø£Ø³Ù ÙØ´Ù„Øª âŒ";
                msgEl.innerText = `Ø¬Ù…Ø¹Øª ${gameState.score}/5. ØªØ­ØªØ§Ø¬ 3 Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø© Ù„Ù„Ù…Ø±ÙˆØ±.`;
                btnsDiv.innerHTML = `<button class="restart-btn" onclick="startFBGame(${gameState.level})">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø±Ø­Ù„Ø©</button>`;
            }
        }

        function updateLevelBadges(currentLvl) {
            for (let i = 1; i <= 4; i++) {
                const el = document.getElementById(`badge-${i}`);
                el.classList.remove('active');
                if (i === currentLvl) el.classList.add('active');
            }
        }

        // ================= Ø£Ø¯ÙˆØ§Øª Ù…Ø´ØªØ±ÙƒØ© (Ø§Ù„Ù…Ø¤Ù‚Øª) =================
        function startTimer(seconds, barId, onFinish) {
            stopGameTimer();
            const bar = document.getElementById(barId);
            bar.style.width = '100%';
            bar.style.transition = 'none'; // reset
            
            // Force Reflow
            void bar.offsetWidth;

            bar.style.transition = `width ${seconds}s linear`;
            bar.style.width = '0%';

            gameState.interval = setTimeout(onFinish, seconds * 1000);
        }

        function stopGameTimer() {
            if (gameState.interval) clearTimeout(gameState.interval);
            const bars = document.querySelectorAll('.timer-bar');
            bars.forEach(b => {
                b.style.transition = 'none';
                b.style.width = b.style.width; // freeze
            });
        }

        function handleTimeout(containerId, correct, nextBtnId) {
            const allBtns = document.querySelectorAll(`#${containerId} .option-btn`);
            allBtns.forEach(b => {
                b.classList.add('disabled');
                if (b.innerText === correct) b.classList.add('correct');
            });
            document.getElementById(nextBtnId).style.display = 'block';
        }

    </script>
</body>
</html>